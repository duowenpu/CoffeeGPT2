<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <title>Welcome to International Spouse Coffee</title>
    <!-- 样式保持不变 -->
    <style>
        /* 你的原始样式代码 */
    </style>
</head>
<body>
    <div class="container">
        <h1>Welcome to International Spouse Coffee</h1>
        <h3>You can talk to our Large Language Model (Beta) for more specific questions!</h3>

        <div class="resource-section">
            <div class="resource-item">
                <img src="https://imgproxy.gamma.app/resize/quality:80/resizing_type:fit/width:2000/https://cdn.gamma.app/3z1bjdrda36ixll/generated-images/Cxbb1D-cY77AHNvZMZOFk.png" alt="English Classes from CCIS">
                <h4>English Classes from CCIS</h4>
                <p>All English Classes are open to Stanford international students, postdoctoral scholars, and their family members with <em>intermediate to advanced English proficiency</em>. The classes are taught by experienced volunteers.</p>
            </div>
            <div class="resource-item">
                <img src="https://imgproxy.gamma.app/resize/quality:80/resizing_type:fit/width:2000/https://cdn.gamma.app/3z1bjdrda36ixll/generated-images/CcXXduHEvpWD46Wdyh7C9.png" alt="Winter Quarter Program">
                <h4>Winter Quarter Program</h4>
                <p>Every quarter, an enthusiastic team of volunteers offers a great variety of programs. You can participate remotely & in-person in a wide range of activities, such as cooking classes, conversation groups, or well-being workshops, just to name a few.</p>
            </div>
            <div class="resource-item">
                <img src="https://imgproxy.gamma.app/resize/quality:80/resizing_type:fit/width:2000/https://cdn.gamma.app/3z1bjdrda36ixll/generated-images/hJNy3nLWHbOmXrNmrnPuD.png" alt="CCIS Programs">
                <h4>CCIS Programs</h4>
                <p>CCIS supports international graduate students, visiting scholars, postdocs, and their families at Stanford University by offering gracious and helpful connections between Stanford Internationals and the community.</p>
            </div>
            <div id="chatbot-container"></div>
        </div>

    <script src="https://lf-cdn.coze.cn/obj/unpkg/flow-platform/chat-app-sdk/1.2.0-beta.3/libs/cn/index.js"></script>
    <script>
        async function initializeChatbot() {
            try {
                // 从 API 获取 Token
                const response = await fetch('/api/get-token');
                const { token } = await response.json();

                new CozeWebSDK.WebChatClient({
                    config: {
                        bot_id: '7476135415767449611',
                    },
                    componentProps: {
                        title: 'Coze',
                        container: document.getElementById('chatbot-container'),
                        style: {
                            background: '#f0f0f0',
                        }
                    },
                    auth: {
                        type: 'token',
                        token: token,
                        onRefreshToken: async () => {
                            const refreshResponse = await fetch('/api/get-token');
                            const { token: newToken } = await refreshResponse.json();
                            return newToken;
                        }
                    }
                });
            } catch (error) {
                console.error('Failed to initialize chatbot:', error);
            }
        }

        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', initializeChatbot);
    </script>
</body>
</html>
